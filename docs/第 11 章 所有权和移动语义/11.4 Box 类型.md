# 11.4 Box 类型

Box 类型是一种常用的指针类型，代表“拥有所有权的指针”，类似于 C++ 里面的`unique_ptr`或 Java 中的对象引用。（严格来说，`unique_ptr<T>`更像 `Option<Box<T>>`）。

通过`Box<T>`指针，可以在运行时创建不确定大小的数据结构，并且允许多个所有者之间共享这些数据结构。
与直接使用裸指针相比，Box 指针提供了更多的安全性和语义保证，在 Rust 代码中被广泛地使用。

用法如下：

```rust
struct T{
    value: i32
}

fn main() {
    let p = Box::new(T{value: 1});
    println!("{}", p.value);
}
```

此时，`p`会包含指向堆内存中 struct T 类型数据的指针，并持有该内存空间的所有权。当 Box 对象`p`超出其作用域时，`Box<T>`的`drop`函数会被自动调用，从而释放其所占用的内存空间。

Box 类型永远执行的是 move 语义，不能是 copy 语义。原因大家想想就可以明白，Rust 中的 copy 语义就是浅复制。
对于 Box 这样的类型而言，浅复制必然会造成二次释放问题。

对于 Rust 里面的所有变量，在使用前一定要合理初始化，否则会出现编译错误。对于`Box<T>`/`&T`/`&mut T` 这样的类型，合理初始化意味着它一定指向了某个具体的对象，不可能是空。如果用户确实需要“可能为空的”指针，必须使用类型`Option<Box<T>>`。
